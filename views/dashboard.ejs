<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
  <title>Dashboard</title>
  <style>
    body {
      background-color: #000000; /* Black */
      color: #000000; /* Black */
    }

    .dashboard-container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 50px;
    }

    .dashboard-section {
      background-color: #333333; /* Dark Grey */
      border: 1px solid #555555; /* Medium Grey */
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
      overflow-y: auto;
      max-height: 600px;
      width: 100%;
      padding: 20px;
      color: #000000; /* Black */
    }

    .accordion-button {
      background-color: #555555; /* Medium Grey */
      color: #ffffff;
    }

    .accordion-button:hover {
      background-color: #777777; /* Light Grey */
    }

    .btn-primary {
      background-color: #2c3e50; /* Dark Grey Blue */
      border: none;
      width: 100%;
    }

    .btn-primary:hover {
      background-color: #34495e; /* Darker Grey Blue */
    }

    .btn-danger {
      background-color: #e74c3c; /* Dark Red */
      border: none;
      width: 100%;
    }

    .btn-danger:hover {
      background-color: #c0392b; /* Darker Red */
    }
  </style>
</head>

<body>

  <!-- PARTIAL FOR HEADER -->
  <%- include('_header') %> <% if(locals.user) {%>
  <div class="dashboard-container">
    <!-- Student list section -->
    <div class="dashboard-section">
      <h3 class="mt-2">Students list</h3>
      <div class="accordion accordion-flush" id="accordionStudents">
        <% for (student of all_students) {%>
        <div class="accordion-item my-2">
          <h2 class="accordion-header" id="heading<%= student._id %>">
            <button
              class="accordion-button"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#collapse<%= student._id %>"
              aria-expanded="false"
              aria-controls="collapse<%= student._id %>"
            >
              <span class="fw-semibold text-capitalize"
                ><%= student.name %></span
              >
            </button>
          </h2>
          <div
            id="collapse<%= student._id %>"
            class="accordion-collapse collapse"
            aria-labelledby="heading<%= student._id %>"
            data-bs-parent="#accordionStudents"
          >
            <div class="accordion-body">
              <p>Email: <%= student.email %></p>
              <p>College: <%= student.college %></p>
              <p>Batch: <%= student.batch %></p>
              <p>Status: <%= student.placementStatus %></p>

              <!-- Actions -->
              <div class="d-grid gap-2">
                <a href="/student/edit-student/<%= student.id %>" class="btn btn-primary">Edit</a>
                <a href="/student/destroy/<%= student.id %>" class="btn btn-danger">Delete</a>
              </div>
            </div>
          </div>
        </div>
        <% } %>
      </div>
    </div>
    <!-- Interviews section -->
    <div class="dashboard-section">
      <h3 class="mt-2">Scheduled Interviews</h3>
      <div class="accordion accordion-flush" id="accordionInterviews">
        <% for (interview of all_interviews) {%>
        <div class="accordion-item my-2">
          <h2 class="accordion-header" id="heading<%= interview._id %>">
            <button
              class="accordion-button"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#collapse<%= interview._id %>"
              aria-expanded="false"
              aria-controls="collapse<%= interview._id %>"
            >
              <span class="fw-semibold text-uppercase"
                ><%= interview.company %></span
              >
            </button>
          </h2>
          <div
            id="collapse<%= interview._id %>"
            class="accordion-collapse collapse"
            aria-labelledby="heading<%= interview._id %>"
            data-bs-parent="#accordionInterviews"
          >
            <div class="accordion-body">
              <p>Date: <%= interview.date %></p>
              <p>Location: <%= interview.location %></p>
              <p>Interviewer: <%= interview.interviewer %></p>

              <!-- Enrolled students -->
              <div class="enrolled-students">
                <h5>Enrolled Students</h5>
                <% for (enrolledStudent of interview.students) { %>
                <div class="enrolled-student mb-2">
                  <p>Name: <%= enrolledStudent.student.name %></p>
                  <p>Email: <%= enrolledStudent.student.email %></p>
                  <p>Result: <%= enrolledStudent.result %></p>
                  <a href="/interview/deallocate/<%= enrolledStudent.student.id %>/<%= interview.id %>"
                    class="btn btn-danger">Delete</a>
                </div>
                <% } %>
              </div>

              <!-- Add student form -->
              <div class="add-student-form">
                <h5 class="mt-2">Add Student</h5>
                <form action="/interview/enroll-in-interview/<%= interview.id %>" method="POST">
                  <div class="mb-3">
                    <label for="student_email" class="form-label">Student Email</label>
                    <input type="email" class="form-control" id="student_email" name="email" required />
                  </div>
                  <div class="mb-3">
                    <label for="result" class="form-label">Result</label>
                    <select id="result" class="form-select" name="result" required>
                      <option selected>PASS</option>
                      <option>FAIL</option>
                      <option>On Hold</option>
                      <option>Didn't attempt</option>
                    </select>
                  </div>
                  <button type="submit" class="btn btn-primary">Add Student</button>
                </form>
              </div>
            </div>
          </div>
        </div>
        <% } %>
      </div>
    </div>
  </div>
  <% } %>

  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
    integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
    integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
    crossorigin="anonymous"></script>
</body>

</html>
